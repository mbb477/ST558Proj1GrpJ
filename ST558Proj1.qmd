---
title: "ST558 Project 1"
author: "M. Sweitzer, M. Beebe"
format: html
editor: visual
---

# Data processing first steps

## Data set EDU01a

### Import the Data

```{r, echo=FALSE}
suppressPackageStartupMessages(library(tidyverse))
```


```{r}
library(tidyverse)
library(readr)
census_1a_original <- read_csv("https://www4.stat.ncsu.edu/~online/datasets/EDU01a.csv")
head(census_1a_original)
#view(census_1a_original)
```

### Select and Pivot

```{r}
census_1a_condensed <- census_1a_original |>
  select(Area_name, STCOU, ends_with("D")) |>
  rename(area_name = Area_name) |>
  pivot_longer(cols = 3:12, 
               names_to = "item_id", 
               values_to = "measurement")
head(census_1a_condensed) 
#view(census_1a_condensed)
```

### Add year and survey code columns

```{r}
census_1a_add <- census_1a_condensed |>
  mutate(year = (as.numeric(substr(item_id, 8, 9)) + 1900),
         survey_code = substr(item_id, 1, 7))
census_1a_add
```

### Create two datasets with non-county and county level data



### Add new variable for county level tibble




### Add new variable for non-county level tibble




# Data processing function creation

## Import data set EDU01b

```{r}
census_1b_original <- read_csv("https://www4.stat.ncsu.edu/~online/datasets/EDU01b.csv")
head(census_1b_original)
```


## Function for steps 1 and 2

```{r}
process_data1 <- function(tibble_df, default_var_name = "measurement") {
  tibble_df |>
    select(Area_name, STCOU, ends_with("D")) |>
    rename(area_name = Area_name) |>
    pivot_longer(cols = 3:12, 
                 names_to = "item_id", 
                 values_to = default_var_name)
}
#test function
result_step_1_2 <- process_data1(census_1b_original)
result_step_1_2
```

## Function for step 3

```{r}
process_data2 <- function(tibble_df) {
  tibble_df |>
    mutate(year = (as.numeric(substr(item_id, 8, 9)) + 1900),
           survey_code = substr(item_id, 1, 7))
}
result_step_3 <- process_data2(result_step_1_2)
result_step_3
```


## Function for step 5

## Function for step 6

##Function for step 4

## Final data processing wrapper function

```{r}
data_processing_wrapper <- function(url, default_var_name = "measurement") {
  result <- read_csv(url) |>
    process_data1() |>
    process_data2()
  return(result)
}
data_processing_wrapper("https://www4.stat.ncsu.edu/~online/datasets/EDU01b.csv")
```

